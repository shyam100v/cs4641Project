{"name":"What makes a YouTube video trend?","tagline":"","body":"# What makes a YouTube video trend?\r\n\r\n## Introduction/Background:\r\nYouTube is an online video-sharing platform with billions of users, posting and watching content for entertainment and education. YouTube monetizes popular videos for the number of views as it increases the use and popularity of the platform itself. With our project, we hope to provide insights on how to make a video trend on YouTube and predict the popularity of a video given certain features. \r\n\r\n\r\n## Dataset: \r\n-> https://www.kaggle.com/datasnaek/youtube-new <br/>\r\nThis dataset includes several months of data on daily trending YouTube videos. Data includes the video title, channel title, publish time, tags, views, likes and dislikes, description, and comment count for up to 200 trending videos per day for several regions. More information like the channel’s age, channel's video count, and subscriber count have been added using the YouTube API. From this dataset, we will only be using the USA's, Canada's, and Great Britain's trending video data. \r\n\r\n#### Write about YouTube API and out data collection\r\n\r\n\r\n## Cleaning up the data\r\nYoutube fosters content from all around the world, so we have deleted video entries in the dataset that are not in english to easier analyze the data, as not everyone in our team speaks other languages such as french. We have also removed null entries, separated the publishing time column into specific month, day, year, and time columns, and handled outliers using hard thresholds and by using the mean and standard deviation. \r\n\r\n### Regarding duplicates in the data\r\nThere are duplicates in the old and new data. A lot of videos in old Data did not have Video ID. They are marked as \"notAvailable\" in videoID. The old data had 80362 duplicates. There were totally 105094 data points in old data. 76.5% of old data were duplicates. The videos with highest number of views was retained. The new dataset had 8276 duplicates and 1483 unique values. Now totally we have 24502 (old) + 1483 (new) = 25985 unique points\r\n\r\n### Data Format\r\nThe csv format of final file that contains both Old and New data:\r\n|                  \t   |                        |                               |\r\n| -------------------- | ---------------------- | ----------------------------- |\r\n|1. regionTrending\t   |12. videoDislikes       |23. thumbnail_link\t            |\r\n|2. trendingRank\t     |13. videoCommentCount   |24. comments_disabled\t        |\r\n|3. timeFetched\t       |14. videoDescription    |25. ratings_disabled\t          |\r\n|4. videoId\t           |15. videoLicenced\t      |26. video_error_or_removed\t    |\r\n|5. videoTitle\t       |16. channelTitle\t      |27. publishDateCorrectFormat   |\r\n|6. videoCategoryId\t   |17. channelId\t          |28. trendingDateCorrectFormat  |\t\r\n|7. videoPublishTime   |18. channelDescription  |29. dayDifference              |\r\n|8. videoDuration\t     |19. channelPublishedAt  |30. publishedZTime             |\r\n|9. videoTags\t         |20. channelViewCount    |31. publishedZTimeFloat\t      |\t\r\n|10. videoViews\t       |21. channelSubsCount    |32. publishedDayOfWeek         |\r\n|11. videoLikes\t       |22. channelVideoCount\t  |33. newOrOldData               |\r\n\t\r\n\r\n  \r\nNote the following for old data:\r\n1. Added a column trendingRank and made it 0 for all rows for old data\r\n2. Following columns are made as 0: channelViewCount, channelSubsCount, channelVideoCount, channelId\r\n3. Following columns are made as \"notAvailable\": videoDuration, videoLicenced, channelDescription, channelPublishedAt\r\n4. Correct Date format is DD-MM-YY (Sorry to the American born)\r\n\r\nFor the new data:\r\n\r\nthumbnail_link, comments_disabled, ratings_disabled, video_error_or_removed are marked as 'notAvailable'\r\n\r\n## Working of combiningData.ipynb\r\n\r\nAll the new data files obtained from YouTube using the API must be in a subfolder \"scrapedData\\\" and must contain \"csvOut\" as part of their file name. The old data is in an excel file in the master folder (not inside any subfolders) as \"finalOldData.xlsx\". It is already in the correct format. The day difference between published date and the trending date is already calculated for old data. This python script generates two csv files: \"newDataOnly_csv_newFormat.csv\" (which contains only the new data in the correct format) and \"oldAndNewData.csv\" (concatenated with old data). Both the files are placed in the master folder. The script will take some time to read from \"finalOldData.xlsx\" and some time to write the larger output csv file. THis script does not clean the data. It only combines the two data pieces in the right format.\r\n\r\n\r\n## Principal Component Analysis(PCA)\r\nWe selected some properties from original video dataset as features of videos, including trending rank, video category, number of views, likes, and dislikes, number of comments, publish time, and video channel related features. For features like duration of video and publish time, we preprocessed our data such that they are represented in the same unit(second) and in a 24-hour time scale.\r\nWe combined all 12 features into a training dataset and apply PCA. PCA was used to reduce the dimension of features through capturing variation. Here is the cumulative explained variance plot. \r\n\r\n![pca_variance](https://raw.githubusercontent.com/shyam100v/cs4641Project/master/image/pca_variance.PNG)\r\n\r\nFrom the plot, we can see that at 6 components, we will get a desired cumulative explained variance(0.9). We also made two component PCA scatter plots to give us some visualizations.\r\n\r\n![pca_views](https://raw.githubusercontent.com/shyam100v/cs4641Project/master/image/pca_views.PNG)\r\n![pca_likes](https://raw.githubusercontent.com/shyam100v/cs4641Project/master/image/pca_likes.PNG)\r\n![pca_dislikes](https://raw.githubusercontent.com/shyam100v/cs4641Project/master/image/pca_dislikes.PNG)\r\n\r\nFrom the scatter plots, we do can see number of views, likes, and dislikes are correlated. Low number of views, low number of likes, and low number of dislikes are all clustered at the middle-left part of the graph.\r\n\r\n## DBSCAN\r\n**Publishing Times**\\\r\nUsing DBSCAN clustering on the video views and publishing time features, we can see that the optimal time frame to publish videos on YouTube is from about 1:30 to 8:30 pm GMT; however, we did find many noise points and the clusters found were quite low in view count. \r\n![dbscan_clusters](https://raw.githubusercontent.com/shyam100v/cs4641Project/master/image/dbscan_clusters.PNG)\r\n\r\n**Video Titles**\\\r\nOne of our main expected outcomes for the overall analysis of youtube videos was that video titles with similar characteristics to clickbait titles would have a higher view count. The main quantifiable characteristics that we seemed to find in all clickbait titles were capital letters and punctuation marks such as exlcamations points and question marks. We also figured that the length of the title could play a role as longer titles can give more information on the context of the videos. Using these three characteristics as a starting point, we manipulated our data to quanitfy these characteristics and then used DBSCAN to cluster them. Hopefully, we would be able to see clear clusters and relationships between the characteristics and the number of views. The below graphs are the results.\r\n\r\n![title length dbscan](https://raw.githubusercontent.com/shyam100v/cs4641Project/master/image/Title_Length_DBSCAN.png)\r\n\r\n![capital letters dbscan](https://raw.githubusercontent.com/shyam100v/cs4641Project/master/image/Num_Caps_DBSCAN.png)\r\n\r\n![punctuation dbscan](https://raw.githubusercontent.com/shyam100v/cs4641Project/master/image/Num_Puncs_DBSCAN.png)\r\n\r\nIn the graph, the darkest purple points represent the outliers or, in other words, the points that did not fit into any cluster. We can see here that there actually a much smaller correlation between the view count of a video and its title's characteristics. The largest clusters in the first two graphs show that there is practically no relation between the length of the title or the number of capital letters in the title and the view count. But, when looking at the clusters at a higher view count, we can actually see a little of the opposite of our expected outcome. Instead of long video titles, we can see higher view count clusters aroung the midpoint in video titles and instead of having a lot of capital letters, we actually see clusters with less capital letters have a higher view count. Finally, with the punctuation marks, we can see that clusters with high view counts actually have on average little to no punctuation marks. \r\n\r\nTo conlcude our findings, we can see that the majority of videos do not rely on the characteristics of the video titles. For those that do have some correlation, we can see that the findings are the opposite of what we originally expected to see.\r\n\r\n\r\n\r\n\r\n## Linear Regression\r\nFirst, an analysis of the correlation between different variables was performed. Looking at the first row, it is seen that only likes, dislikes and comment count are correlated with the number of views of a video.\r\n![Correlation table](https://raw.githubusercontent.com/shyam100v/cs4641Project/master/image/Correlation%20table.PNG)\r\n\r\nThen, a statistical summary of each of our variables was obtained. This analysis is useful to potentially identify any outliers in the data.\r\n![max-min-std](https://raw.githubusercontent.com/shyam100v/cs4641Project/master/image/max-min-std.PNG)\r\n\r\nBased on the table above, the data for the number of views, likes and dislikes was modified to remove any data points that were outside 2 standard deviations from their respective mean. Then, a basic histogram of the number of views, likes and dislikes was plotted. As it is appreciated on the graphs below, the three graphs are heavily skewed which is understandable — most common YouTubers probably won’t have that many views, likes and dislikes. Ideally, the data should resemble a Gaussian distribution. Luckily, a log tranformation can be applied to the number of views, likes and dislikes to achieve that.\r\n\r\n![Number of views without logs](https://raw.githubusercontent.com/shyam100v/cs4641Project/master/image/Number%20of%20views%20without%20logs.PNG)\r\n![Number of dislikes without logs](https://raw.githubusercontent.com/shyam100v/cs4641Project/master/image/Number%20of%20dislikes%20without%20logs.PNG)\r\n![Number of likes without logs](https://raw.githubusercontent.com/shyam100v/cs4641Project/master/image/Number%20of%20likes%20without%20logs.PNG)\r\n![Log number of dislikes](https://raw.githubusercontent.com/shyam100v/cs4641Project/master/image/Log%20number%20of%20dislikes.PNG)\r\n![Log number of likes](https://raw.githubusercontent.com/shyam100v/cs4641Project/master/image/Log%20number%20of%20likes.PNG)\r\n![Log number of views](https://raw.githubusercontent.com/shyam100v/cs4641Project/master/image/Log%20number%20of%20views.PNG)\r\n\r\nUsing this 3 histograms above, a linear regression of the log number of views versus the log number of likes and dislikes can be plotted. As expected, both correlations show an R^2 greater than 0.6, showing a big correlation between both the number of likes and dislikes and the number of views of a video. This analysis was only performed on these 2 variables since no other variables appear to correlate with the number of views of a video\r\n\r\n![Linear regression of log views versus log dislikes](https://raw.githubusercontent.com/shyam100v/cs4641Project/master/image/Linear%20regression%20of%20log%20views%20versus%20log%20dislikes.PNG)\r\n![Linear regression of log views versus log likes](https://raw.githubusercontent.com/shyam100v/cs4641Project/master/image/Linear%20regression%20of%20log%20views%20versus%20log%20likes.PNG)\r\n\r\n## Multiple Regression\r\nAs we are trying to aid users in creating a popular Youtube video, we will look at one of the main features (excluding actual video content) that can manipulated by the video maker; the video title. Via Multiple Regression, we will use the quantifiable features of a video title to create a model that can predict the number of views a video will recieve based on it's title. In this case we will be looking at the length, number of capital letters, and number of exclamation and questions marks in the video title. Once again, we chose these parameters as they are common characteristics of clickbait titles, which are made exclusively for people to be attracted to.\r\n\r\nFirst we loaded our data and calculated the needed parameters from the given titles. Now, a major hinderance with our original data was that there were a few drastic outliers in relation to the number of views a video had. In order to eliminate those, we removed any data points that were more than one standard deviation away from the mean (which was a very large standard deviation, so it was fitting to only use one). But even then, our data was very skewed. In order to have a balanced model, we would ideally like a Gaussian distribution, so we decided to take the log of the number of views, which did in fact give us a Gausian ditribution. The below graphs show the data distribution before and after applying the log function. \r\n\r\n![Views before log function](https://raw.githubusercontent.com/shyam100v/cs4641Project/master/image/MultReg_viewskew.png)\r\n\r\n![Views after log function](https://raw.githubusercontent.com/shyam100v/cs4641Project/master/image/MultReg_viewlog.png)\r\n\r\nNow that our data is better suited for analysis, we moved on to actually applying the regression model. Since we used three parameters (length, number of capital letters, and number of exclamation and queston marks) versus the number of views on a video, it would have resulted in a 3-dimensional model in a 4-dimensional space. As it is difficult to understand a 4-dimensional model, the following graphs show the regression models of just two parameters each versus the log of the number of views of the videos in order to give an overall picture.\r\n\r\n![length vs caps](https://raw.githubusercontent.com/shyam100v/cs4641Project/master/image/MultReg_lengthcapsreg.png)\r\n\r\n![length vs puncs](https://raw.githubusercontent.com/shyam100v/cs4641Project/master/image/MultReg_lengthpuncsreg.png)\r\n\r\n![caps vs puncs](https://raw.githubusercontent.com/shyam100v/cs4641Project/master/image/MultReg_capspuncsreg.png)\r\n\r\nAs can be seen above, the grey plane in each of the graphs is the regression model that fits the set of data points the best. Since our data points are fairly spread out and do not show much correlation to the number of views, the fitted planes are relatively flat, and center ariund the area where most of the data points are in order to at least fit for a majority of videos. \r\n\r\nFinally, to see how well our prediction model actually worked, we graphed a random set of data points that were used in our testing phase and compared them to their predictions.\r\n\r\n![predicted vs actual](https://raw.githubusercontent.com/shyam100v/cs4641Project/master/image/MultReg_predvsact.png)\r\n\r\nAs we can see here, the model tends to predict within the 200000 to 400000 views range, and this is probably due to the very flat model that can be seen in the previous graphs. Though the model seems to overestimate the number of views for anything below 300000 views, it is actually proportional in a sense and predicts slighty less for those with less views and predicts slightly more for those with more views. Now, since it can be seen that the videos with a high number of views have very low predictions, we also calculated the error of the preditcions of videos with different ranges of views.\r\n\r\n![accuracy](https://raw.githubusercontent.com/shyam100v/cs4641Project/master/image/MultReg_accuracy.png)\r\n\r\nIn the above graph, it can be seen that the lower the actual number of views a video has, the more accurate this model will be in its predictions. \r\n\r\nIn conclusion, we see that the characteristics of a video title actually have a much smaller effect on the popularity of a video than we originally believed, especially on videos with extremely high view count. This is why this multiple regression model was so flat, because majority of videos actually have a relatively low view count no matter how they construct their video titles.\r\n\r\n\r\n## Gradient Boosting Regressor\r\n\r\nGradient Boosting Regressor is a form of tree ensemble model which builds an ensemble of weak predistion models. A new tree is trained at each step additively over the previous stage with the loss function as the residual error from previous stage. \r\n\r\n__Model used__: The [sklearn.ensemble.GradientBoostingRegressor model](https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.GradientBoostingRegressor.html) from sklearn module is used. The module also provides a method to visualize the __importance of individual features__ after the model is trained. We use this to infer the most important contributors in predicting the number of views of a video (See [here](https://raw.githubusercontent.com/shyam100v/cs4641Project/master/simpleDataAnalysis.ipynb)).\r\n\r\n__Data Preparation__: The data collected using the __YouTube API__ is used to train and test the model with the logarithm of number of views of a video as the target label. Only the videos that have a view count between 1000 and 10 million are used. Sample of the data used is shown:\r\n\r\n![dataSample](https://raw.githubusercontent.com/shyam100v/cs4641Project/master/image/dataSample1.png)\r\n\r\n__Model performance and Feature importance__\r\n\r\nWith all the above listed features, the model has an RMSE of __772445__ views. We infer from the plot that the number of likes and dislikes are the most important features in predicting the number of views. \r\n\r\n![featureImportance1](https://raw.githubusercontent.com/shyam100v/cs4641Project/master/image/mdi1.png)\r\n\r\nWhile this is intuitive, this does not serve as a good model for prediction since likes, dislikes and comments are not known in advance. After removing these three features, the feature importance is plotted below:\r\n\r\n![featureImportance2](https://raw.githubusercontent.com/shyam100v/cs4641Project/master/image/mdi3.png)\r\n\r\nIt is seen that the channel subscriber count, the age of the video and the number of videos in the channel are the most important predictors. \r\n\r\n\r\n\r\n## Future Work \r\n\r\nThe following are a few possible directions in which our work can be extended:\r\n1. Analysis of the impact of keywords in the title on number of views\r\n2. Deeper analysis of relation between channel popularity and video popularity\r\n3. Estimating potential size of audience for a given video type (Music, Movie trailer, etc), language among other features.\r\n\r\n\r\n\r\n## References:\r\n[1] Gill, Phillipa et al. \"Youtube traffic characterization: a view from the edge.\" Proceedings of the 7th ACM SIGCOMM conference on Internet measurement. 2007. <br/>\r\n[2] F Figueiredoet al \"The tube over time: characterizing popularity growth of youtube videos.\" Proceedings of the fourth ACM international conference on Web search and data mining. 2011.<br/>\r\n[3] G. Chatzopoulou et al, \"A First Step Towards Understanding Popularity in YouTube,\" INFOCOM IEEE Conference on Computer Communications Workshops, CA, 2010 <br/>\r\n[4] Coding, Sigma. “How to Build a Linear Regression Model in Python | Part 1.” Youtube, Apr. 2019, www.youtube.com/watch?v=MRm5sBfdBBQ.\r\n\r\n\r\n\r\n","note":"Don't delete this file! It's used internally to help with page regeneration."}